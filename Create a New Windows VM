## Creates a New Windows VM using PowerShell##
## Variables ##
$ResourceGroupName = "Yoshi"
$NameofVM = "Yoshi-WIN1"
$Location = "West US"
$VirtualNetworkName = "Vnet-GalacticCivilWar"
$SubnetName = "GalacticCivilWar"
$SecurityGroupName = "NSG-GalacticCivilWar"
$PublicIpAddressName = "myPublicIpAddress"
$OpenPorts = "22,80,3389"

New-AzVM `
  -ResourceGroupName "Yoshi" `
  -Name "Yoshi-WIN1" `
  -Location "West US" `
  -VirtualNetworkName "myVnet1" `
  -SubnetName "mySubnet1" `
  -SecurityGroupName "myNetworkSecurityGroup" `
  -PublicIpAddressName "myPublicIpAddress" `
  -OpenPorts 22,80,3389

##Connect to the virtual machine##
Get-AzPublicIpAddress -ResourceGroupName "Yoshi" | Select "IpAdress"

##Create a RDP session from local computer. Input the IP address of the VM in the command##
mstsc /v: publicIpAddress
